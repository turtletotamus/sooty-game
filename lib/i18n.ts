export type Locale = "en" | "zh-TW";

export const translations: Record<
  Locale,
  Record<string, string | Record<string, string>>
> = {
  en: {
    home: {
      title: "Sooty",
      subtitle: "",
      footer: "",
    },
    petWindow: {
      windowTitle: "Sooty",
      replaceSooty: "Replace Sooty",
      age: "Age",
      mood: "Mood",
      sleeping: "Sleeping",
      walking: "Walking",
      resume: "Resume",
      pause: "Pause",
      stop: "Stop",
      hunger: "Hunger",
      thirst: "Thirst",
      happiness: "Happiness",
      energy: "Energy",
      tip: "Click on {{name}} to interact! Use the timer for focused work sessions.",
      gettingBig: "{{name}} is getting big!",
      confirmReplace: "Replace with a new Sooty? This will reset age and stats.",
      meetNew: "Meet the new Sooty!",
      widget: "Widget",
      widgetTitle: "Show in corner (draggable)",
      darkMode: "Dark mode",
      lightMode: "Day mode",
      appearanceLabel: "Appearance",
    },
    emotion: {
      joy: "Pure Joy",
      anger: "Angry",
      sorrow: "Sad",
      neutral: "Neutral",
    },
    actions: {
      feed: "Feed",
      drink: "Drink",
      sleep: "Sleep",
      play: "Play",
      walk: "Walk",
      love: "Love",
      breathe: "Deep breath",
      timer: "Timer",
    },
    weather: {
      sunny: "Sunny",
      rain: "Rain",
      snow: "Snow",
      autumn: "Autumn",
    },
    walkScene: {
      forest: "Forest",
      beach: "Beach",
      city: "City",
    },
    notifications: {
      missedYou: "{{name}} missed you!",
      tooMuchPoking: "Hey! Too much poking!",
      letsWalk: "Let's go for a walk!",
      dontWakeMe: "Grr! Don't wake me!",
      grrSleeping: "Grr! I was sleeping!",
      soRelaxed: "So relaxed~",
      greatWork: "Great work! Time for a break!",
      breakOver: "Break over! Ready to focus!",
      cozyRain: "Cozy rain...",
      soPretty: "So pretty!",
      autumnVibes: "Autumn vibes~",
      warmSunshine: "Warm sunshine!",
      walkBack: "Back from a {{min}}m walk ({{scene}})!",
    },
    actionMessages: {
      yum: "Yum yum!",
      refreshing: "Refreshing!",
      zzz: "Zzz...",
      soFun: "So fun!",
      walkTime: "Walk time!",
      lovesYou: "Loves you!",
    },
    breathing: {
      title: "Breathe with {{name}}",
      intro: "Follow the rhythm. Inhale and exhale slowly to relax together.",
      cycles: "{{n}} cycles total",
      start: "Start",
      breatheIn: "Breathe In",
      hold: "Hold",
      breatheOut: "Breathe Out",
      rest: "Rest",
      getReady: "Get ready",
      done: "Well done! You and {{name}} feel calmer.",
    },
    pomodoro: {
      title: "Focus with {{name}}",
      intro: "Stay focused and productive. {{name}} will help you manage your work sessions and breaks.",
      workBreak: "Work for {{work}} minutes, then take a {{break}}-minute break",
      customize: "Customize durations and sounds in settings",
      start: "Start",
      breakStart: "Break Start",
      focus: "Focus",
      break: "Break",
      timerDurations: "Timer Durations",
      alarmSound: "Alarm Sound",
      testAlarm: "Test",
      backgroundSound: "Background Sound",
      none: "None",
      tick: "Tick",
      fire: "Fire",
      rain: "Rain",
      workTime: "Work time",
      breakTime: "Break time",
      skip: "Skip",
      completed: "Session complete!",
    },
    customizer: {
      title: "Replace Sooty (Demo)",
      subtitle: "Shape and color apply to your Sooty. Confirming will replace with a new one.",
      shape: "Shape",
      color: "Color",
      confirm: "Confirm",
      cancel: "Cancel",
    },
    shapes: {
      circle: "Circle",
      square: "Square",
      star: "Star",
      triangle: "Triangle",
      heart: "Heart",
    },
    widget: {
      openFull: "Open full app",
    },
  },
  "zh-TW": {
    home: {
      title: "小精靈",
      subtitle: "",
      footer: "",
    },
    petWindow: {
      windowTitle: "小精靈",
      replaceSooty: "更換小精靈",
      age: "年齡",
      mood: "心情",
      sleeping: "睡覺中",
      walking: "散步中",
      resume: "繼續",
      pause: "暫停",
      stop: "停止",
      hunger: "飢餓",
      thirst: "口渴",
      happiness: "幸福",
      energy: "精力",
      tip: "點擊 {{name}} 互動！用番茄鐘專心工作。",
      gettingBig: "{{name}} 長好大！",
      confirmReplace: "確定要更換一隻新的小精靈嗎？這會重置年齡與狀態。",
      meetNew: "認識新小精靈！",
      widget: "陪伴模式",
      widgetTitle: "顯示在右下角（可拖曳）",
      darkMode: "深夜模式",
      lightMode: "白天模式",
      appearanceLabel: "造型",
    },
    emotion: {
      joy: "開心",
      anger: "生氣",
      sorrow: "難過",
      neutral: "普通",
    },
    actions: {
      feed: "餵食",
      drink: "喝水",
      sleep: "睡覺",
      play: "玩耍",
      walk: "散步",
      love: "抱抱",
      breathe: "深呼吸",
      timer: "番茄鐘",
    },
    weather: {
      sunny: "晴天",
      rain: "雨天",
      snow: "下雪",
      autumn: "秋天",
    },
    walkScene: {
      forest: "森林",
      beach: "海邊",
      city: "城市",
    },
    notifications: {
      missedYou: "{{name}} 想你了！",
      tooMuchPoking: "嘿！別一直戳！",
      letsWalk: "一起去散步吧！",
      dontWakeMe: "唔……不要吵我！",
      grrSleeping: "唔……我在睡覺！",
      soRelaxed: "好放鬆～",
      greatWork: "做得很好！休息一下吧！",
      breakOver: "休息結束！繼續專心！",
      cozyRain: "下雨好舒服……",
      soPretty: "好漂亮！",
      autumnVibes: "秋天氛圍～",
      warmSunshine: "陽光暖暖的！",
      walkBack: "{{min}} 分鐘散步回來囉（{{scene}}）！",
    },
    actionMessages: {
      yum: "好吃！",
      refreshing: "好解渴！",
      zzz: "zzZ……",
      soFun: "好好玩！",
      walkTime: "散步囉！",
      lovesYou: "愛你！",
    },
    breathing: {
      title: "和 {{name}} 一起呼吸",
      intro: "跟著節奏，慢慢吸氣、吐氣，一起放鬆。",
      cycles: "共 {{n}} 輪",
      start: "開始",
      breatheIn: "吸氣",
      hold: "憋氣",
      breatheOut: "吐氣",
      rest: "休息",
      getReady: "準備好了嗎",
      done: "做得好！你和 {{name}} 都更放鬆了。",
    },
    pomodoro: {
      title: "和 {{name}} 一起專心",
      intro: "保持專注與效率。{{name}} 陪你管理工作和休息時間。",
      workBreak: "工作 {{work}} 分鐘，休息 {{break}} 分鐘",
      customize: "可在設定中調整時間與提示音",
      start: "開始",
      breakStart: "開始休息",
      focus: "專注",
      break: "休息",
      timerDurations: "計時設定",
      alarmSound: "提醒聲",
      testAlarm: "試聽",
      backgroundSound: "背景音",
      none: "無",
      tick: "滴答",
      fire: "爐火",
      rain: "雨聲",
      workTime: "工作時間",
      breakTime: "休息時間",
      skip: "略過",
      completed: "本輪完成！",
    },
    customizer: {
      title: "更換小精靈（造型 DEMO）",
      subtitle: "形狀與顏色會套用到全域的小精靈。確認後會重置為一隻新的。",
      shape: "形狀",
      color: "顏色",
      confirm: "確認",
      cancel: "取消",
    },
    shapes: {
      circle: "圓形",
      square: "正方形",
      star: "星形",
      triangle: "三角形",
      heart: "愛心",
    },
    widget: {
      openFull: "開啟完整版",
    },
  },
};

function getNested(
  obj: Record<string, string | Record<string, string>>,
  path: string
): string | undefined {
  const parts = path.split(".");
  let current: unknown = obj;
  for (const p of parts) {
    if (current && typeof current === "object" && p in current)
      current = (current as Record<string, unknown>)[p];
    else return undefined;
  }
  return typeof current === "string" ? current : undefined;
}

export function t(
  locale: Locale,
  key: string,
  params?: Record<string, string | number>
): string {
  const raw = getNested(translations[locale] as Record<string, string | Record<string, string>>, key);
  const str = raw ?? getNested(translations.en as Record<string, string | Record<string, string>>, key) ?? key;
  if (!params) return str;
  return Object.entries(params).reduce(
    (s, [k, v]) => s.replace(new RegExp(`\\{\\{${k}\\}\\}`, "g"), String(v)),
    str
  );
}
